<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Editar Consulta - MediPlus</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <h2>Editar Consulta ID {{ consulta.id }}</h2>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, msg in messages %}
                    <div class="flash {{ category }}">{{ msg }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <form method="POST">
            <label>Paciente:</label>
            <select name="id_paciente" disabled>
                <option value="{{ consulta.id_paciente }}">{{ consulta.id_paciente }}</option>
            </select>

            <label>Receta (opcional):</label>
            <select name="id_receta">
                <option value="">--Ninguna--</option>
                {% for r in recetas %}
                    <option value="{{ r.id }}" {% if r.id == consulta.id_receta %}selected{% endif %}>
                        {{ r.descripcion }}
                    </option>
                {% endfor %}
            </select>

            <label>Fecha:</label>
            <input type="date" name="fecha" value="{{ consulta.fecha }}" required>

            <label>Comentarios:</label>
            <textarea name="comentarios">{{ consulta.comentarios }}</textarea>

            <label>Valor:</label>
            <input type="number" name="valor" step="0.01" value="{{ consulta.valor }}">

            <button type="submit">Actualizar Consulta</button>
        </form>

        <form action="{{ url_for('consulta_bp.eliminar_consulta', consulta_id=consulta.id) }}" method="POST">
            <button type="submit" onclick="return confirm('Â¿Eliminar esta consulta?')">Eliminar Consulta</button>
        </form>

        <a href="{{ url_for('consulta_bp.listar_consultas') }}" class="menu-button">Volver</a>
    </div>
</body>
</html>
